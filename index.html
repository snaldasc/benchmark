<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Benchmark</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    #map {
      height: 600px;
      width: 100%;
    }
    body {
      font-family: sans-serif;
      padding: 1em;
    }
    #filters {
      margin-bottom: 20px;
    }
    #filterSelect, #categorySelect {
      margin-right: 10px;
    }
    ul {
      padding: 0;
      list-style: none;
    }
    li {
      cursor: pointer;
      padding: 5px;
      margin: 3px;
      background-color: #f0f0f0;
    }
    li:hover {
      background-color: #ddd;
    }
  </style>
</head>
<body>
  <h2>Benchmark</h2>

  <!-- Filter-Optionen -->
  <div id="filters">
    <label for="categorySelect">Filter nach Kategorie:</label>
    <select id="categorySelect">
      <option value="all">Alle</option>
      <option value="Bank">Bank</option>
      <option value="Park">Park</option>
      <option value="Museum">Museum</option>
    </select>

    <label for="filterSelect">Filter nach Tags:</label>
    <select id="filterSelect">
      <option value="all">Alle anzeigen</option>
      <option value="water">Wasser</option>
      <option value="harbour">Hafen</option>
      <option value="historisch">Historisch</option>
      <option value="kulturell">Kulturell</option>
    </select>
  </div>

  <ul id="locationList"></ul>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const map = L.map('map').setView([53.5716, 9.6740], 14);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap-Mitwirkende'
    }).addTo(map);

    let locations = [];  // Array f端r die Standorte
    let locationMarkers = []; // Array f端r Marker

    // Standorte laden
    fetch('https://raw.githubusercontent.com/snaldasc/benchmark/main/locations.json')
      .then(response => response.json())
      .then(data => {
        locations = data;
        locations.forEach(loc => {
          const circle = L.circle([loc.latitude, loc.longitude], {
            color: 'red',
            fillColor: '#f03',
            fillOpacity: 0.5,
            radius: 300
          }).addTo(map);

          const popupContent = ` 
            <h3>${loc.name}</h3>
            <p>${loc.description}</p>
            <img src="${loc.image}" alt="${loc.name}" style="width: 200px; height: auto;">
          `;
          circle.bindPopup(popupContent);

          locationMarkers.push({ loc, circle });

          // Standort in der Liste anzeigen
          const listItem = document.createElement('li');
          listItem.textContent = loc.name;
          listItem.dataset.category = loc.type;
          listItem.dataset.tags = loc.tags.join(','); // tags als String speichern
          listItem.dataset.name = loc.name.toLowerCase();
          listItem.dataset.description = loc.description.toLowerCase();

          listItem.addEventListener('click', () => {
            map.setView([loc.latitude, loc.longitude], 14);
            circle.openPopup();
          });

          document.getElementById('locationList').appendChild(listItem);
        });
      })
      .catch(err => {
        console.error('Fehler beim Laden der Daten:', err);
      });

    // Filter f端r Kategorie (Aussehen)
    document.getElementById('categorySelect').addEventListener('change', (e) => {
      const selectedCategory = e.target.value;
      const selectedTags = document.getElementById('filterSelect').value;
      filterLocations(selectedCategory, selectedTags);
    });

    // Filter f端r Tags (Wasser, Hafen, etc.)
    document.getElementById('filterSelect').addEventListener('change', (e) => {
      const selectedTags = e.target.value;
      const selectedCategory = document.getElementById('categorySelect').value;
      filterLocations(selectedCategory, selectedTags);
    });

    // Funktion, die Standorte basierend auf Kategorie und Tags filtert
    function filterLocations(selectedCategory, selectedTags) {
      locationMarkers.forEach(markerObj => {
        const { loc, circle } = markerObj;
        let show = true;

        // Filter nach Kategorie
        if (selectedCategory !== 'all' && loc.type !== selectedCategory) {
          show = false;
        }

        // Filter nach Tags (Wasser, Hafen etc.)
        if (selectedTags !== 'all' && !loc.tags.includes(selectedTags)) {
          show = false;
        }

        // Marker anzeigen oder ausblenden
        if (show) {
          circle.addTo(map);  // Marker anzeigen
        } else {
          map.removeLayer(circle);  // Marker ausblenden
        }
      });

      // Filtere die Standort-Liste nach Kategorie und Filter
      const listItems = document.querySelectorAll('#locationList li');
      listItems.forEach(item => {
        const category = item.dataset.category;
        const tags = item.dataset.tags;
        const description = item.dataset.description;

        let show = true;

        // Filter nach Kategorie
        if (selectedCategory !== 'all' && category !== selectedCategory) {
          show = false;
        }

        // Filter nach Tags
        if (selectedTags !== 'all' && !tags.includes(selectedTags)) {
          show = false;
        }

        item.style.display = show ? '' : 'none';
      });
    }
  </script>
</body>
</html>
